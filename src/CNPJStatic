using System.Runtime.CompilerServices;

namespace DocumentoHelper;

public readonly partial struct CNPJ
{
    public static bool Validate(string value) =>
        new CNPJ(value).IsValid;

    public static string GenerateUnformatted()
    {
        Span<char> dest = stackalloc char[14];
        GenerateImpl(dest);
        return new string(dest);
    }

    [MethodImpl(MethodImplOptions.AggressiveOptimization | MethodImplOptions.AggressiveInlining)]
    private static void GenerateImpl(Span<char> dest)
    {
        var random = new Random();
        Span<int> digits = stackalloc int[14];
        for (var i = 0; i < 12; i++)
            digits[i] = random.Next(0, 9);

        digits[12] = CriaDigitoVerificador1(digits);
        digits[13] = CriaDigitoVerificador2(digits);

        for (var i = 0; i < digits.Length; i++)
            dest[i] = (char)(digits[i] + '0');
    }
}